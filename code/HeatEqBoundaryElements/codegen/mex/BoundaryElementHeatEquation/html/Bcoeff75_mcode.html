<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="40,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">vals</span> = Bcoeff(<span class="var type1" id="S3T1U6">ksi</span>,<span class="var type1" id="S4T1U7">j</span>,<span class="var type1" id="S5T1U8">x</span>,<span class="var type1" id="S6T1U9">t</span>,<span class="var type1" id="S7T2U10">timePoints</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="40,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% evaluate the coefficient B at the  boundary ksi=0 or ksi=1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% for the index j which describes the time steps timePoints_j, at time t and space</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% point x</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% timePoints is a vector describing the time descritized domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,6" id="srcline6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="40,7" id="srcline7"> 7</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T3:U7"><span class="var type1" id="S6T1U14">t</span>&lt;=<span class="mxinfo" id="T1:U9"><span class="var type1" id="S7T2U16">timePoints</span>(<span class="var type1" id="S4T1U17">j</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="40,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo" id="T1:U12"><span class="var type1" id="S2T1U20">vals</span> = <span class="mxinfo" id="T1:U14">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,9" id="srcline9"> 9</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T3:U15"><span class="var type1" id="S6T1U26">t</span>&gt;<span class="mxinfo" id="T1:U17"><span class="var type1" id="S7T2U28">timePoints</span>(<span class="var type1" id="S4T1U29">j</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T3:U20"><span class="var type1" id="S6T1U31">t</span>&lt;= <span class="mxinfo" id="T1:U22"><span class="var type1" id="S7T2U33">timePoints</span>(<span class="mxinfo" id="T1:U24"><span class="var type1" id="S4T1U35">j</span>+<span class="mxinfo" id="T1:U26">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T3:U27"><span class="var type1" id="S5T1U38">x</span>==<span class="var type1" id="S3T1U39">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="40,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo" id="T1:U30"><span class="var type1" id="S2T1U42">vals</span> = <span class="mxinfo" id="T1:U32">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,11" id="srcline11">11</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T3:U33"><span class="var type1" id="S6T1U48">t</span>&gt;<span class="mxinfo" id="T1:U35"><span class="var type1" id="S7T2U50">timePoints</span>(<span class="var type1" id="S4T1U51">j</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T3:U38"><span class="var type1" id="S6T1U53">t</span>&lt;= <span class="mxinfo" id="T1:U40"><span class="var type1" id="S7T2U55">timePoints</span>(<span class="mxinfo" id="T1:U42"><span class="var type1" id="S4T1U57">j</span>+<span class="mxinfo" id="T1:U44">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T3:U45"><span class="var type1" id="S5T1U60">x</span>~=<span class="var type1" id="S3T1U61">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="40,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo" id="T1:U48"><span class="var type1" id="S8T1U64">z0</span>   = <span class="mxinfo" id="T1:U50"><span class="mxinfo" id="T1:U51">abs(<span class="mxinfo" id="T1:U52"><span class="var type1" id="S5T1U69">x</span>-<span class="var type1" id="S3T1U70">ksi</span></span>)</span>/(<span class="mxinfo" id="T1:U55"><span class="mxinfo" id="T1:U56">2</span>*<span class="mxinfo" id="T1:U57">sqrt(<span class="mxinfo" id="T1:U58"><span class="var type1" id="S6T1U77">t</span>-<span class="mxinfo" id="T1:U60"><span class="var type1" id="S7T2U79">timePoints</span>(<span class="var type1" id="S4T1U80">j</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,13" id="srcline13">13</a></span><span class="line">    <span class="mxinfo" id="T1:U63"><span class="var type1" id="S2T1U83">vals</span> = <span class="mxinfo" id="T1:U65"><span class="mxinfo" id="T1:U66">-(<span class="mxinfo" id="T1:U67">erfc(<span class="var type1" id="S8T1U89">z0</span>)</span>)</span>/<span class="mxinfo" id="T1:U69">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,14" id="srcline14">14</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T3:U70"><span class="var type1" id="S6T1U93">t</span>&gt;<span class="mxinfo" id="T1:U72"><span class="var type1" id="S7T2U95">timePoints</span>(<span class="mxinfo" id="T1:U74"><span class="var type1" id="S4T1U97">j</span>+<span class="mxinfo" id="T1:U76">1</span></span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="40,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo" id="T1:U77"><span class="var type1" id="S8T1U101">z0</span>   = <span class="mxinfo" id="T1:U79"><span class="mxinfo" id="T1:U80">abs(<span class="mxinfo" id="T1:U81"><span class="var type1" id="S5T1U106">x</span>-<span class="var type1" id="S3T1U107">ksi</span></span>)</span>/(<span class="mxinfo" id="T1:U84"><span class="mxinfo" id="T1:U85">2</span>*<span class="mxinfo" id="T1:U86">sqrt(<span class="mxinfo" id="T1:U87"><span class="var type1" id="S6T1U114">t</span>-<span class="mxinfo" id="T1:U89"><span class="var type1" id="S7T2U116">timePoints</span>(<span class="var type1" id="S4T1U117">j</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo" id="T1:U92"><span class="var type1" id="S12T1U120">z1</span>   = <span class="mxinfo" id="T1:U94"><span class="mxinfo" id="T1:U95">abs(<span class="mxinfo" id="T1:U96"><span class="var type1" id="S5T1U125">x</span>-<span class="var type1" id="S3T1U126">ksi</span></span>)</span>/(<span class="mxinfo" id="T1:U99"><span class="mxinfo" id="T1:U100">2</span>*<span class="mxinfo" id="T1:U101">sqrt(<span class="mxinfo" id="T1:U102"><span class="var type1" id="S6T1U133">t</span>-<span class="mxinfo" id="T1:U104"><span class="var type1" id="S7T2U135">timePoints</span>(<span class="mxinfo" id="T1:U106"><span class="var type1" id="S4T1U137">j</span>+<span class="mxinfo" id="T1:U108">1</span></span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo" id="T1:U109"><span class="var type1" id="S2T1U141">vals</span> = <span class="mxinfo" id="T1:U111">(<span class="mxinfo" id="T1:U112"><span class="mxinfo" id="T1:U113">erf(<span class="var type1" id="S8T1U147">z0</span>)</span>-<span class="mxinfo" id="T1:U115">erf(<span class="var type1" id="S12T1U150">z1</span>)</span></span>)/<span class="mxinfo" id="T1:U117">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,18" id="srcline18">18</a></span><span class="line"><span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="40,19" id="srcline19">19</a></span><span class="line">   <span class="mxinfo" id="T1:U118"><span class="var type1" id="S2T1U155">vals</span> = <span class="mxinfo" id="T1:U120">0</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="40,20" id="srcline20">20</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,21" id="srcline21">21</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
