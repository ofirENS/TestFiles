<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"><span class="keyword">function</span> <span class="mxinfo" id="T2:U1"><span class="var type1" id="S63T2U727"><span class="message error" id="M10F110C">vals</span></span></span> = Acoeff(<span class="mxinfo" id="T2:U2"><span class="var type2" id="S64T2V1U730">ksi</span></span>,<span class="var type1" id="S65T2U731">j</span>,<span class="mxinfo" id="T2:U5"><span class="var type2" id="S66T2V1U732">x</span></span>,<span class="var type1" id="S67T2U733">t</span>,<span class="var type1" id="S68T1U734">timePoints</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line"><span class="comment">% evaluate the coefficient A at the  boundary ksi=0 or ksi=1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"><span class="comment">% for the index j which describes the time steps timePoints_j, at time t and space</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"><span class="comment">% point x</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"><span class="comment">% timePoints is a vector describing the time descritized domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T4:U9"><span class="var type1" id="S67T2U738">t</span>&lt;=<span class="mxinfo" id="T2:U11"><span class="var type1" id="S68T1U740">timePoints</span>(<span class="var type1" id="S65T2U741">j</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">    <span class="mxinfo" id="T2:U14"><span class="var type1" id="S63T2U744">vals</span>=<span class="mxinfo" id="T2:U16">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U17"><span class="var type1" id="S67T2U750">t</span>&gt;<span class="mxinfo" id="T2:U19"><span class="var type1" id="S68T1U752">timePoints</span>(<span class="var type1" id="S65T2U753">j</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U22"><span class="var type1" id="S67T2U755">t</span>&lt;= <span class="mxinfo" id="T2:U24"><span class="var type1" id="S68T1U757">timePoints</span>(<span class="mxinfo" id="T2:U26"><span class="var type1" id="S65T2U759">j</span>+<span class="mxinfo" id="T2:U28">1</span></span>)</span></span> &amp;&amp; <span class="var type1" id="S66T2U762">x</span>==<span class="var type1" id="S64T2U763">ksi</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">    <span class="mxinfo" id="T2:U31"><span class="var type1" id="S63T2U766">vals</span> = <span class="mxinfo" id="T2:U33">sqrt(<span class="mxinfo" id="T2:U34">(<span class="mxinfo" id="T2:U35"><span class="var type1" id="S67T2U772">t</span>-<span class="mxinfo" id="T2:U37"><span class="var type1" id="S68T1U774">timePoints</span>(<span class="var type1" id="S65T2U775">j</span>)</span></span>)/<span class="mxinfo" id="T2:U40">pi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U41"><span class="var type1" id="S67T2U782">t</span>&gt;<span class="mxinfo" id="T2:U43"><span class="var type1" id="S68T1U784">timePoints</span>(<span class="var type1" id="S65T2U785">j</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U46"><span class="var type1" id="S67T2U787">t</span>&lt;= <span class="mxinfo" id="T2:U48"><span class="var type1" id="S68T1U789">timePoints</span>(<span class="mxinfo" id="T2:U50"><span class="var type1" id="S65T2U791">j</span>+<span class="mxinfo" id="T2:U52">1</span></span>)</span></span> &amp;&amp; <span class="var type1" id="S66T2U794">x</span>~=<span class="var type1" id="S64T2U795">ksi</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">    <span class="var type0" id="S71T0U798">z0</span> = abs(<span class="var type0" id="S66T0U803">x</span>-<span class="var type0" id="S64T0U804">ksi</span>)/(2*sqrt(<span class="var type0" id="S67T0U811">t</span>-<span class="var type0" id="S68T0U813">timePoints</span>(<span class="var type0" id="S65T0U814">j</span>)));</span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">    <span class="var type0" id="S63T0U817">vals</span> = abs(<span class="var type0" id="S66T0U823">x</span>-<span class="var type0" id="S64T0U824">ksi</span>)/(2*sqrt(pi)) *(exp(-<span class="var type0" id="S71T0U839">z0</span>^2)/<span class="var type0" id="S71T0U841">z0</span> - sqrt(pi)*(erfc(<span class="var type0" id="S71T0U850">z0</span>)));</span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U55"><span class="var type1" id="S67T2U854">t</span>&gt;<span class="mxinfo" id="T2:U57"><span class="var type1" id="S68T1U856">timePoints</span>(<span class="mxinfo" id="T2:U59"><span class="var type1" id="S65T2U858">j</span>+<span class="mxinfo" id="T2:U61">1</span></span>)</span></span> &amp;&amp; <span class="var type1" id="S66T2U861">x</span>==<span class="var type1" id="S64T2U862">ksi</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">    <span class="mxinfo" id="T2:U64"><span class="var type1" id="S63T2U865">vals</span> = <span class="mxinfo" id="T2:U66"><span class="mxinfo" id="T2:U67">sqrt(<span class="mxinfo" id="T2:U68">(<span class="mxinfo" id="T2:U69"><span class="var type1" id="S67T2U872">t</span>-<span class="mxinfo" id="T2:U71"><span class="var type1" id="S68T1U874">timePoints</span>(<span class="var type1" id="S65T2U875">j</span>)</span></span>)/<span class="mxinfo" id="T2:U74">pi</span></span>)</span>-<span class="mxinfo" id="T2:U75">sqrt(<span class="mxinfo" id="T2:U76">(<span class="mxinfo" id="T2:U77"><span class="var type1" id="S67T2U883">t</span>-<span class="mxinfo" id="T2:U79"><span class="var type1" id="S68T1U885">timePoints</span>(<span class="mxinfo" id="T2:U81"><span class="var type1" id="S65T2U887">j</span>+<span class="mxinfo" id="T2:U83">1</span></span>)</span></span>)/<span class="mxinfo" id="T2:U84">pi</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U85"><span class="var type1" id="S67T2U894">t</span>&gt;<span class="mxinfo" id="T2:U87"><span class="var type1" id="S68T1U896">timePoints</span>(<span class="mxinfo" id="T2:U89"><span class="var type1" id="S65T2U898">j</span>+<span class="mxinfo" id="T2:U91">1</span></span>)</span></span> &amp;&amp; <span class="var type1" id="S66T2U901">x</span>~=<span class="var type1" id="S64T2U902">ksi</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line">    <span class="var type0" id="S71T0U905">z0</span> = abs(<span class="var type0" id="S66T0U910">x</span>-<span class="var type0" id="S64T0U911">ksi</span>)/(2*sqrt(<span class="var type0" id="S67T0U918">t</span>-<span class="var type0" id="S68T0U920">timePoints</span>(<span class="var type0" id="S65T0U921">j</span>)));</span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">    <span class="var type0" id="S75T0U924">z1</span> = abs(<span class="var type0" id="S66T0U929">x</span>-<span class="var type0" id="S64T0U930">ksi</span>)/(2*sqrt(<span class="var type0" id="S67T0U937">t</span>-<span class="var type0" id="S68T0U939">timePoints</span>(<span class="var type0" id="S65T0U941">j</span>+1)));</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line">    <span class="var type0" id="S63T0U945">vals</span> = abs(<span class="var type0" id="S66T0U951">x</span>-<span class="var type0" id="S64T0U952">ksi</span>)/(2*sqrt(pi)) *(exp(-(<span class="var type0" id="S71T0U969">z0</span>^2))/<span class="var type0" id="S71T0U971">z0</span> - exp(-(<span class="var type0" id="S75T0U978">z1</span>^2))/<span class="var type0" id="S75T0U980">z1</span> +sqrt(pi)*(erf(<span class="var type0" id="S71T0U990">z0</span>)-erf(<span class="var type0" id="S75T0U993">z1</span>)));</span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line"></span></span>
</pre>
