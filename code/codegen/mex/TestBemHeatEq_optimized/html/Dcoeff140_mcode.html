<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S99T2U1195">vals</span> = Dcoeff(<span class="var type1" id="S100T14U1198">y</span>,<span class="var type1" id="S101T2U1199">j</span>,<span class="var type1" id="S102T2U1200">x</span>,<span class="var type1" id="S103T2U1201">t</span>,<span class="var type1" id="S104T1U1202">timePoints</span>,<span class="var type1" id="S105T14U1203">f</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line"><span class="comment">% Calculate the integral int_0^1(f(y,t_j)*A_{yj}(x,t)dy) by midpoint</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line"><span class="comment">% integration rule</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line"><span class="comment">% the spatial integration of all points y at time t_j</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line"><span class="mxinfo" id="T14:U8"><span class="var type1" id="S106T14U1206">a</span>        = <span class="mxinfo" id="T14:U10">zeros(<span class="mxinfo" id="T2:U11">1</span>,<span class="mxinfo" id="T2:U12">numel(<span class="var type1" id="S100T14U1212">y</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line"><span class="mxinfo" id="T2:U14"><span class="var type1" id="S99T2U1215">vals</span> = <span class="mxinfo" id="T2:U16">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line"><span class="var type0" id="S106T0U1220">a</span>(1) = <span class="message error" id="M14F140C"><span class="fcn" id="F141N3:B1223">Acoeff</span>(<span class="mxinfo" id="T2:U17"><span class="var type1" id="S100T14U1225">y</span>(<span class="mxinfo" id="T2:U19">1</span>)</span>,<span class="var type1" id="S101T2U1227">j</span>,<span class="mxinfo" id="T2:U21"><span class="var type1" id="S102T2U1228">x</span></span>,<span class="var type1" id="S103T2U1229">t</span>,<span class="var type1" id="S104T1U1230">timePoints</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S110T2U1233">aIdx</span> = <span class="mxinfo" id="T35:U26"><span class="mxinfo" id="T2:U27">2</span>:numel(<span class="var type1" id="S100T14U1238">y</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line">    <span class="var type0" id="S106T0U1242">a</span>(<span class="var type0" id="S110T0U1243">aIdx</span>) = <span class="message error" id="M15F140C"><span class="fcn" id="F147N3:B1245">Acoeff</span>(<span class="mxinfo" id="T2:U29"><span class="var type1" id="S100T14U1247">y</span>(<span class="var type1" id="S110T2U1248">aIdx</span>)</span>,<span class="var type1" id="S101T2U1249">j</span>,<span class="mxinfo" id="T2:U33"><span class="var type1" id="S102T2U1250">x</span></span>,<span class="var type1" id="S103T2U1251">t</span>,<span class="var type1" id="S104T1U1252">timePoints</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line">    <span class="mxinfo" id="T2:U37"><span class="var type1" id="S99T2U1255">vals</span> = <span class="mxinfo" id="T2:U39"><span class="var type1" id="S99T2U1257">vals</span>+ <span class="mxinfo" id="T2:U41"><span class="mxinfo" id="T2:U42"><span class="mxinfo" id="T2:U43">0.5</span>*(<span class="mxinfo" id="T2:U44"><span class="mxinfo" id="T2:U45"><span class="mxinfo" id="T2:U46"><span class="var type1" id="S106T14U1265">a</span>(<span class="var type1" id="S110T2U1266">aIdx</span>)</span>*<span class="mxinfo" id="T2:U49"><span class="var type1" id="S105T14U1268">f</span>(<span class="var type1" id="S110T2U1269">aIdx</span>)</span></span>+<span class="mxinfo" id="T2:U52"><span class="mxinfo" id="T2:U53"><span class="var type1" id="S106T14U1272">a</span>(<span class="mxinfo" id="T2:U55"><span class="var type1" id="S110T2U1274">aIdx</span>-<span class="mxinfo" id="T2:U57">1</span></span>)</span>*<span class="mxinfo" id="T2:U58"><span class="var type1" id="S105T14U1277">f</span>(<span class="mxinfo" id="T2:U60"><span class="var type1" id="S110T2U1279">aIdx</span>-<span class="mxinfo" id="T2:U62">1</span></span>)</span></span></span>)</span>*(<span class="mxinfo" id="T2:U63"><span class="mxinfo" id="T2:U64"><span class="var type1" id="S100T14U1284">y</span>(<span class="var type1" id="S110T2U1285">aIdx</span>)</span>-<span class="mxinfo" id="T2:U67"><span class="var type1" id="S100T14U1287">y</span>(<span class="mxinfo" id="T2:U69"><span class="var type1" id="S110T2U1289">aIdx</span>-<span class="mxinfo" id="T2:U71">1</span></span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228">228</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229">229</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230">230</a></span><span class="line"></span></span>
</pre>
