<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"><span class="keyword">function</span> <span class="mxinfo" id="T2:U1"><span class="var type1" id="S63T2U727"><span class="message error" id="M16F141C">vals</span></span></span> = Acoeff(<span class="var type1" id="S64T2U730">ksi</span>,<span class="var type1" id="S65T2U731">j</span>,<span class="mxinfo" id="T2:U4"><span class="var type2" id="S66T2V1U732">x</span></span>,<span class="var type1" id="S67T2U733">t</span>,<span class="var type1" id="S68T1U734">timePoints</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line"><span class="comment">% evaluate the coefficient A at the  boundary ksi=0 or ksi=1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"><span class="comment">% for the index j which describes the time steps timePoints_j, at time t and space</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"><span class="comment">% point x</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"><span class="comment">% timePoints is a vector describing the time descritized domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T4:U8"><span class="var type1" id="S67T2U738">t</span>&lt;=<span class="mxinfo" id="T2:U10"><span class="var type1" id="S68T1U740">timePoints</span>(<span class="var type1" id="S65T2U741">j</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">    <span class="mxinfo" id="T2:U13"><span class="var type1" id="S63T2U744">vals</span>=<span class="mxinfo" id="T2:U15">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U16"><span class="var type1" id="S67T2U750">t</span>&gt;<span class="mxinfo" id="T2:U18"><span class="var type1" id="S68T1U752">timePoints</span>(<span class="var type1" id="S65T2U753">j</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U21"><span class="var type1" id="S67T2U755">t</span>&lt;= <span class="mxinfo" id="T2:U23"><span class="var type1" id="S68T1U757">timePoints</span>(<span class="mxinfo" id="T2:U25"><span class="var type1" id="S65T2U759">j</span>+<span class="mxinfo" id="T2:U27">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U28"><span class="var type1" id="S66T2U762">x</span>==<span class="var type1" id="S64T2U763">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">    <span class="mxinfo" id="T2:U31"><span class="var type1" id="S63T2U766">vals</span> = <span class="mxinfo" id="T2:U33">sqrt(<span class="mxinfo" id="T2:U34">(<span class="mxinfo" id="T2:U35"><span class="var type1" id="S67T2U772">t</span>-<span class="mxinfo" id="T2:U37"><span class="var type1" id="S68T1U774">timePoints</span>(<span class="var type1" id="S65T2U775">j</span>)</span></span>)/<span class="mxinfo" id="T2:U40">pi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U41"><span class="var type1" id="S67T2U782">t</span>&gt;<span class="mxinfo" id="T2:U43"><span class="var type1" id="S68T1U784">timePoints</span>(<span class="var type1" id="S65T2U785">j</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U46"><span class="var type1" id="S67T2U787">t</span>&lt;= <span class="mxinfo" id="T2:U48"><span class="var type1" id="S68T1U789">timePoints</span>(<span class="mxinfo" id="T2:U50"><span class="var type1" id="S65T2U791">j</span>+<span class="mxinfo" id="T2:U52">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U53"><span class="var type1" id="S66T2U794">x</span>~=<span class="var type1" id="S64T2U795">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">    <span class="mxinfo" id="T2:U56"><span class="var type1" id="S71T2U798">z0</span> = <span class="mxinfo" id="T2:U58"><span class="mxinfo" id="T2:U59">abs(<span class="mxinfo" id="T2:U60"><span class="var type1" id="S66T2U803">x</span>-<span class="var type1" id="S64T2U804">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U63"><span class="mxinfo" id="T2:U64">2</span>*<span class="mxinfo" id="T2:U65">sqrt(<span class="mxinfo" id="T2:U66"><span class="var type1" id="S67T2U811">t</span>-<span class="mxinfo" id="T2:U68"><span class="var type1" id="S68T1U813">timePoints</span>(<span class="var type1" id="S65T2U814">j</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">    <span class="mxinfo" id="T2:U71"><span class="var type1" id="S63T2U817">vals</span> = <span class="mxinfo" id="T2:U73"><span class="mxinfo" id="T2:U74"><span class="mxinfo" id="T2:U75">abs(<span class="mxinfo" id="T2:U76"><span class="var type1" id="S66T2U823">x</span>-<span class="var type1" id="S64T2U824">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U79">2*sqrt(pi)</span>)</span> *(<span class="mxinfo" id="T2:U80"><span class="mxinfo" id="T2:U81"><span class="mxinfo" id="T2:U82">exp(<span class="mxinfo" id="T2:U83">-<span class="mxinfo" id="T2:U84"><span class="var type1" id="S71T2U839">z0</span>^2</span></span>)</span>/<span class="var type1" id="S71T2U841">z0</span></span> - <span class="mxinfo" id="T2:U87"><span class="mxinfo" id="T2:U88">sqrt(pi)</span>*(<span class="mxinfo" id="T2:U89">erfc(<span class="var type1" id="S71T2U850">z0</span>)</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U91"><span class="var type1" id="S67T2U854">t</span>&gt;<span class="mxinfo" id="T2:U93"><span class="var type1" id="S68T1U856">timePoints</span>(<span class="mxinfo" id="T2:U95"><span class="var type1" id="S65T2U858">j</span>+<span class="mxinfo" id="T2:U97">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U98"><span class="var type1" id="S66T2U861">x</span>==<span class="var type1" id="S64T2U862">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">    <span class="mxinfo" id="T2:U101"><span class="var type1" id="S63T2U865">vals</span> = <span class="mxinfo" id="T2:U103"><span class="mxinfo" id="T2:U104">sqrt(<span class="mxinfo" id="T2:U105">(<span class="mxinfo" id="T2:U106"><span class="var type1" id="S67T2U872">t</span>-<span class="mxinfo" id="T2:U108"><span class="var type1" id="S68T1U874">timePoints</span>(<span class="var type1" id="S65T2U875">j</span>)</span></span>)/<span class="mxinfo" id="T2:U111">pi</span></span>)</span>-<span class="mxinfo" id="T2:U112">sqrt(<span class="mxinfo" id="T2:U113">(<span class="mxinfo" id="T2:U114"><span class="var type1" id="S67T2U883">t</span>-<span class="mxinfo" id="T2:U116"><span class="var type1" id="S68T1U885">timePoints</span>(<span class="mxinfo" id="T2:U118"><span class="var type1" id="S65T2U887">j</span>+<span class="mxinfo" id="T2:U120">1</span></span>)</span></span>)/<span class="mxinfo" id="T2:U121">pi</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U122"><span class="var type1" id="S67T2U894">t</span>&gt;<span class="mxinfo" id="T2:U124"><span class="var type1" id="S68T1U896">timePoints</span>(<span class="mxinfo" id="T2:U126"><span class="var type1" id="S65T2U898">j</span>+<span class="mxinfo" id="T2:U128">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U129"><span class="var type1" id="S66T2U901">x</span>~=<span class="var type1" id="S64T2U902">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line">    <span class="mxinfo" id="T2:U132"><span class="var type1" id="S71T2U905">z0</span> = <span class="mxinfo" id="T2:U134"><span class="mxinfo" id="T2:U135">abs(<span class="mxinfo" id="T2:U136"><span class="var type1" id="S66T2U910">x</span>-<span class="var type1" id="S64T2U911">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U139"><span class="mxinfo" id="T2:U140">2</span>*<span class="mxinfo" id="T2:U141">sqrt(<span class="mxinfo" id="T2:U142"><span class="var type1" id="S67T2U918">t</span>-<span class="mxinfo" id="T2:U144"><span class="var type1" id="S68T1U920">timePoints</span>(<span class="var type1" id="S65T2U921">j</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">    <span class="mxinfo" id="T2:U147"><span class="var type1" id="S75T2U924">z1</span> = <span class="mxinfo" id="T2:U149"><span class="mxinfo" id="T2:U150">abs(<span class="mxinfo" id="T2:U151"><span class="var type1" id="S66T2U929">x</span>-<span class="var type1" id="S64T2U930">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U154"><span class="mxinfo" id="T2:U155">2</span>*<span class="mxinfo" id="T2:U156">sqrt(<span class="mxinfo" id="T2:U157"><span class="var type1" id="S67T2U937">t</span>-<span class="mxinfo" id="T2:U159"><span class="var type1" id="S68T1U939">timePoints</span>(<span class="mxinfo" id="T2:U161"><span class="var type1" id="S65T2U941">j</span>+<span class="mxinfo" id="T2:U163">1</span></span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line">    <span class="mxinfo" id="T2:U164"><span class="var type1" id="S63T2U945">vals</span> = <span class="mxinfo" id="T2:U166"><span class="mxinfo" id="T2:U167"><span class="mxinfo" id="T2:U168">abs(<span class="mxinfo" id="T2:U169"><span class="var type1" id="S66T2U951">x</span>-<span class="var type1" id="S64T2U952">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U172">2*sqrt(pi)</span>)</span> *(<span class="mxinfo" id="T2:U173"><span class="mxinfo" id="T2:U174"><span class="mxinfo" id="T2:U175"><span class="mxinfo" id="T2:U176">exp(<span class="mxinfo" id="T2:U177">-(<span class="mxinfo" id="T2:U178"><span class="var type1" id="S71T2U969">z0</span>^2</span>)</span>)</span>/<span class="var type1" id="S71T2U971">z0</span></span> - <span class="mxinfo" id="T2:U181"><span class="mxinfo" id="T2:U182">exp(<span class="mxinfo" id="T2:U183">-(<span class="mxinfo" id="T2:U184"><span class="var type1" id="S75T2U978">z1</span>^2</span>)</span>)</span>/<span class="var type1" id="S75T2U980">z1</span></span></span> +<span class="mxinfo" id="T2:U187"><span class="mxinfo" id="T2:U188">sqrt(pi)</span>*(<span class="mxinfo" id="T2:U189"><span class="mxinfo" id="T2:U190">erf(<span class="var type1" id="S71T2U990">z0</span>)</span>-<span class="mxinfo" id="T2:U192">erf(<span class="var type1" id="S75T2U993">z1</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line"></span></span>
</pre>
