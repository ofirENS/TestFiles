<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line"><span class="keyword">function</span> <span class="mxinfo" id="T2:U1"><span class="var type1" id="S78T2U996"><span class="message error" id="M24F154C">vals</span></span></span> = Bcoeff(<span class="var type1" id="S79T2U999">ksi</span>,<span class="var type1" id="S80T2U1000">j</span>,<span class="var type1" id="S81T2U1001">x</span>,<span class="var type1" id="S82T2U1002">t</span>,<span class="var type1" id="S83T1U1003">timePoints</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line"><span class="comment">% evaluate the coefficient B at the  boundary ksi=0 or ksi=1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line"><span class="comment">% for the index j which describes the time steps timePoints_j, at time t and space</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line"><span class="comment">% point x</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line"><span class="comment">% timePoints is a vector describing the time descritized domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T4:U7"><span class="var type1" id="S82T2U1007">t</span>&lt;=<span class="mxinfo" id="T2:U9"><span class="var type1" id="S83T1U1009">timePoints</span>(<span class="var type1" id="S80T2U1010">j</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line">    <span class="mxinfo" id="T2:U12"><span class="var type1" id="S78T2U1013">vals</span> = <span class="mxinfo" id="T2:U14">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U15"><span class="var type1" id="S82T2U1019">t</span>&gt;<span class="mxinfo" id="T2:U17"><span class="var type1" id="S83T1U1021">timePoints</span>(<span class="var type1" id="S80T2U1022">j</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U20"><span class="var type1" id="S82T2U1024">t</span>&lt;= <span class="mxinfo" id="T2:U22"><span class="var type1" id="S83T1U1026">timePoints</span>(<span class="mxinfo" id="T2:U24"><span class="var type1" id="S80T2U1028">j</span>+<span class="mxinfo" id="T2:U26">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U27"><span class="var type1" id="S81T2U1031">x</span>==<span class="var type1" id="S79T2U1032">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line">    <span class="mxinfo" id="T2:U30"><span class="var type1" id="S78T2U1035">vals</span> = <span class="mxinfo" id="T2:U32">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U33"><span class="var type1" id="S82T2U1041">t</span>&gt;<span class="mxinfo" id="T2:U35"><span class="var type1" id="S83T1U1043">timePoints</span>(<span class="var type1" id="S80T2U1044">j</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U38"><span class="var type1" id="S82T2U1046">t</span>&lt;= <span class="mxinfo" id="T2:U40"><span class="var type1" id="S83T1U1048">timePoints</span>(<span class="mxinfo" id="T2:U42"><span class="var type1" id="S80T2U1050">j</span>+<span class="mxinfo" id="T2:U44">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U45"><span class="var type1" id="S81T2U1053">x</span>~=<span class="var type1" id="S79T2U1054">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line">    <span class="mxinfo" id="T2:U48"><span class="var type1" id="S84T2U1057">z0</span>   = <span class="mxinfo" id="T2:U50"><span class="mxinfo" id="T2:U51">abs(<span class="mxinfo" id="T2:U52"><span class="var type1" id="S81T2U1062">x</span>-<span class="var type1" id="S79T2U1063">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U55"><span class="mxinfo" id="T2:U56">2</span>*<span class="mxinfo" id="T2:U57">sqrt(<span class="mxinfo" id="T2:U58"><span class="var type1" id="S82T2U1070">t</span>-<span class="mxinfo" id="T2:U60"><span class="var type1" id="S83T1U1072">timePoints</span>(<span class="var type1" id="S80T2U1073">j</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line">    <span class="mxinfo" id="T2:U63"><span class="var type1" id="S78T2U1076">vals</span> = <span class="mxinfo" id="T2:U65"><span class="mxinfo" id="T2:U66">-(<span class="mxinfo" id="T2:U67">erfc(<span class="var type1" id="S84T2U1082">z0</span>)</span>)</span>/<span class="mxinfo" id="T2:U69">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U70"><span class="var type1" id="S82T2U1086">t</span>&gt;<span class="mxinfo" id="T2:U72"><span class="var type1" id="S83T1U1088">timePoints</span>(<span class="mxinfo" id="T2:U74"><span class="var type1" id="S80T2U1090">j</span>+<span class="mxinfo" id="T2:U76">1</span></span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line">    <span class="mxinfo" id="T2:U77"><span class="var type1" id="S84T2U1094">z0</span>   = <span class="mxinfo" id="T2:U79"><span class="mxinfo" id="T2:U80">abs(<span class="mxinfo" id="T2:U81"><span class="var type1" id="S81T2U1099">x</span>-<span class="var type1" id="S79T2U1100">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U84"><span class="mxinfo" id="T2:U85">2</span>*<span class="mxinfo" id="T2:U86">sqrt(<span class="mxinfo" id="T2:U87"><span class="var type1" id="S82T2U1107">t</span>-<span class="mxinfo" id="T2:U89"><span class="var type1" id="S83T1U1109">timePoints</span>(<span class="var type1" id="S80T2U1110">j</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line">    <span class="mxinfo" id="T2:U92"><span class="var type1" id="S88T2U1113">z1</span>   = <span class="mxinfo" id="T2:U94"><span class="mxinfo" id="T2:U95">abs(<span class="mxinfo" id="T2:U96"><span class="var type1" id="S81T2U1118">x</span>-<span class="var type1" id="S79T2U1119">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U99"><span class="mxinfo" id="T2:U100">2</span>*<span class="mxinfo" id="T2:U101">sqrt(<span class="mxinfo" id="T2:U102"><span class="var type1" id="S82T2U1126">t</span>-<span class="mxinfo" id="T2:U104"><span class="var type1" id="S83T1U1128">timePoints</span>(<span class="mxinfo" id="T2:U106"><span class="var type1" id="S80T2U1130">j</span>+<span class="mxinfo" id="T2:U108">1</span></span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line">    <span class="mxinfo" id="T2:U109"><span class="var type1" id="S78T2U1134">vals</span> = <span class="mxinfo" id="T2:U111">(<span class="mxinfo" id="T2:U112"><span class="mxinfo" id="T2:U113">erf(<span class="var type1" id="S84T2U1140">z0</span>)</span>-<span class="mxinfo" id="T2:U115">erf(<span class="var type1" id="S88T2U1143">z1</span>)</span></span>)/<span class="mxinfo" id="T2:U117">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line"></span></span>
</pre>
