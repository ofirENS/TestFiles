<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"><span class="keyword">function</span> <span class="mxinfo" id="T2:U1"><span class="var type1" id="S63T2U727"><span class="message error" id="M19F150C">vals</span></span></span> = Acoeff(<span class="var type1" id="S64T2U730">ksi</span>,<span class="var type1" id="S65T2U731">j</span>,<span class="var type1" id="S66T2U732">x</span>,<span class="var type1" id="S67T2U733">t</span>,<span class="var type1" id="S68T1U734">timePoints</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line"><span class="comment">% evaluate the coefficient A at the  boundary ksi=0 or ksi=1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"><span class="comment">% for the index j which describes the time steps timePoints_j, at time t and space</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"><span class="comment">% point x</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"><span class="comment">% timePoints is a vector describing the time descritized domain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T4:U7"><span class="var type1" id="S67T2U738">t</span>&lt;=<span class="mxinfo" id="T2:U9"><span class="var type1" id="S68T1U740">timePoints</span>(<span class="var type1" id="S65T2U741">j</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">    <span class="mxinfo" id="T2:U12"><span class="var type1" id="S63T2U744">vals</span>=<span class="mxinfo" id="T2:U14">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U15"><span class="var type1" id="S67T2U750">t</span>&gt;<span class="mxinfo" id="T2:U17"><span class="var type1" id="S68T1U752">timePoints</span>(<span class="var type1" id="S65T2U753">j</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U20"><span class="var type1" id="S67T2U755">t</span>&lt;= <span class="mxinfo" id="T2:U22"><span class="var type1" id="S68T1U757">timePoints</span>(<span class="mxinfo" id="T2:U24"><span class="var type1" id="S65T2U759">j</span>+<span class="mxinfo" id="T2:U26">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U27"><span class="var type1" id="S66T2U762">x</span>==<span class="var type1" id="S64T2U763">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">    <span class="mxinfo" id="T2:U30"><span class="var type1" id="S63T2U766">vals</span> = <span class="mxinfo" id="T2:U32">sqrt(<span class="mxinfo" id="T2:U33">(<span class="mxinfo" id="T2:U34"><span class="var type1" id="S67T2U772">t</span>-<span class="mxinfo" id="T2:U36"><span class="var type1" id="S68T1U774">timePoints</span>(<span class="var type1" id="S65T2U775">j</span>)</span></span>)/<span class="mxinfo" id="T2:U39">pi</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U40"><span class="var type1" id="S67T2U782">t</span>&gt;<span class="mxinfo" id="T2:U42"><span class="var type1" id="S68T1U784">timePoints</span>(<span class="var type1" id="S65T2U785">j</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U45"><span class="var type1" id="S67T2U787">t</span>&lt;= <span class="mxinfo" id="T2:U47"><span class="var type1" id="S68T1U789">timePoints</span>(<span class="mxinfo" id="T2:U49"><span class="var type1" id="S65T2U791">j</span>+<span class="mxinfo" id="T2:U51">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U52"><span class="var type1" id="S66T2U794">x</span>~=<span class="var type1" id="S64T2U795">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">    <span class="mxinfo" id="T2:U55"><span class="var type1" id="S71T2U798">z0</span> = <span class="mxinfo" id="T2:U57"><span class="mxinfo" id="T2:U58">abs(<span class="mxinfo" id="T2:U59"><span class="var type1" id="S66T2U803">x</span>-<span class="var type1" id="S64T2U804">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U62"><span class="mxinfo" id="T2:U63">2</span>*<span class="mxinfo" id="T2:U64">sqrt(<span class="mxinfo" id="T2:U65"><span class="var type1" id="S67T2U811">t</span>-<span class="mxinfo" id="T2:U67"><span class="var type1" id="S68T1U813">timePoints</span>(<span class="var type1" id="S65T2U814">j</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">    <span class="mxinfo" id="T2:U70"><span class="var type1" id="S63T2U817">vals</span> = <span class="mxinfo" id="T2:U72"><span class="mxinfo" id="T2:U73"><span class="mxinfo" id="T2:U74">abs(<span class="mxinfo" id="T2:U75"><span class="var type1" id="S66T2U823">x</span>-<span class="var type1" id="S64T2U824">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U78">2*sqrt(pi)</span>)</span> *(<span class="mxinfo" id="T2:U79"><span class="mxinfo" id="T2:U80"><span class="mxinfo" id="T2:U81">exp(<span class="mxinfo" id="T2:U82">-<span class="mxinfo" id="T2:U83"><span class="var type1" id="S71T2U839">z0</span>^2</span></span>)</span>/<span class="var type1" id="S71T2U841">z0</span></span> - <span class="mxinfo" id="T2:U86"><span class="mxinfo" id="T2:U87">sqrt(pi)</span>*(<span class="mxinfo" id="T2:U88">erfc(<span class="var type1" id="S71T2U850">z0</span>)</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U90"><span class="var type1" id="S67T2U854">t</span>&gt;<span class="mxinfo" id="T2:U92"><span class="var type1" id="S68T1U856">timePoints</span>(<span class="mxinfo" id="T2:U94"><span class="var type1" id="S65T2U858">j</span>+<span class="mxinfo" id="T2:U96">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U97"><span class="var type1" id="S66T2U861">x</span>==<span class="var type1" id="S64T2U862">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">    <span class="mxinfo" id="T2:U100"><span class="var type1" id="S63T2U865">vals</span> = <span class="mxinfo" id="T2:U102"><span class="mxinfo" id="T2:U103">sqrt(<span class="mxinfo" id="T2:U104">(<span class="mxinfo" id="T2:U105"><span class="var type1" id="S67T2U872">t</span>-<span class="mxinfo" id="T2:U107"><span class="var type1" id="S68T1U874">timePoints</span>(<span class="var type1" id="S65T2U875">j</span>)</span></span>)/<span class="mxinfo" id="T2:U110">pi</span></span>)</span>-<span class="mxinfo" id="T2:U111">sqrt(<span class="mxinfo" id="T2:U112">(<span class="mxinfo" id="T2:U113"><span class="var type1" id="S67T2U883">t</span>-<span class="mxinfo" id="T2:U115"><span class="var type1" id="S68T1U885">timePoints</span>(<span class="mxinfo" id="T2:U117"><span class="var type1" id="S65T2U887">j</span>+<span class="mxinfo" id="T2:U119">1</span></span>)</span></span>)/<span class="mxinfo" id="T2:U120">pi</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo" id="T4:U121"><span class="var type1" id="S67T2U894">t</span>&gt;<span class="mxinfo" id="T2:U123"><span class="var type1" id="S68T1U896">timePoints</span>(<span class="mxinfo" id="T2:U125"><span class="var type1" id="S65T2U898">j</span>+<span class="mxinfo" id="T2:U127">1</span></span>)</span></span> &amp;&amp; <span class="mxinfo" id="T4:U128"><span class="var type1" id="S66T2U901">x</span>~=<span class="var type1" id="S64T2U902">ksi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line">    <span class="mxinfo" id="T2:U131"><span class="var type1" id="S71T2U905">z0</span> = <span class="mxinfo" id="T2:U133"><span class="mxinfo" id="T2:U134">abs(<span class="mxinfo" id="T2:U135"><span class="var type1" id="S66T2U910">x</span>-<span class="var type1" id="S64T2U911">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U138"><span class="mxinfo" id="T2:U139">2</span>*<span class="mxinfo" id="T2:U140">sqrt(<span class="mxinfo" id="T2:U141"><span class="var type1" id="S67T2U918">t</span>-<span class="mxinfo" id="T2:U143"><span class="var type1" id="S68T1U920">timePoints</span>(<span class="var type1" id="S65T2U921">j</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">    <span class="mxinfo" id="T2:U146"><span class="var type1" id="S75T2U924">z1</span> = <span class="mxinfo" id="T2:U148"><span class="mxinfo" id="T2:U149">abs(<span class="mxinfo" id="T2:U150"><span class="var type1" id="S66T2U929">x</span>-<span class="var type1" id="S64T2U930">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U153"><span class="mxinfo" id="T2:U154">2</span>*<span class="mxinfo" id="T2:U155">sqrt(<span class="mxinfo" id="T2:U156"><span class="var type1" id="S67T2U937">t</span>-<span class="mxinfo" id="T2:U158"><span class="var type1" id="S68T1U939">timePoints</span>(<span class="mxinfo" id="T2:U160"><span class="var type1" id="S65T2U941">j</span>+<span class="mxinfo" id="T2:U162">1</span></span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line">    <span class="mxinfo" id="T2:U163"><span class="var type1" id="S63T2U945">vals</span> = <span class="mxinfo" id="T2:U165"><span class="mxinfo" id="T2:U166"><span class="mxinfo" id="T2:U167">abs(<span class="mxinfo" id="T2:U168"><span class="var type1" id="S66T2U951">x</span>-<span class="var type1" id="S64T2U952">ksi</span></span>)</span>/(<span class="mxinfo" id="T2:U171">2*sqrt(pi)</span>)</span> *(<span class="mxinfo" id="T2:U172"><span class="mxinfo" id="T2:U173"><span class="mxinfo" id="T2:U174"><span class="mxinfo" id="T2:U175">exp(<span class="mxinfo" id="T2:U176">-(<span class="mxinfo" id="T2:U177"><span class="var type1" id="S71T2U969">z0</span>^2</span>)</span>)</span>/<span class="var type1" id="S71T2U971">z0</span></span> - <span class="mxinfo" id="T2:U180"><span class="mxinfo" id="T2:U181">exp(<span class="mxinfo" id="T2:U182">-(<span class="mxinfo" id="T2:U183"><span class="var type1" id="S75T2U978">z1</span>^2</span>)</span>)</span>/<span class="var type1" id="S75T2U980">z1</span></span></span> +<span class="mxinfo" id="T2:U186"><span class="mxinfo" id="T2:U187">sqrt(pi)</span>*(<span class="mxinfo" id="T2:U188"><span class="mxinfo" id="T2:U189">erf(<span class="var type1" id="S71T2U990">z0</span>)</span>-<span class="mxinfo" id="T2:U191">erf(<span class="var type1" id="S75T2U993">z1</span>)</span></span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line"></span></span>
</pre>
